import{_ as l}from"./chunks/Badge.vue_vue_type_style_index_0_lang.08e33858.js";import{_ as p,o,c as e,d as s,f as c,e as t,a}from"./app.9f0c2498.js";const b=JSON.parse('{"title":"自定义配置 Mog Core | 进阶安装","description":"","frontmatter":{"title":"自定义配置 Mog Core | 进阶安装"},"headers":[{"level":2,"title":"启动命令的改变","slug":"启动命令的改变","link":"#启动命令的改变","children":[]},{"level":2,"title":"配置 Core","slug":"配置-core","link":"#配置-core","children":[]},{"level":2,"title":"启动 Core","slug":"启动-core","link":"#启动-core","children":[{"level":3,"title":"","slug":"","link":"#","children":[]}]},{"level":2,"title":"如何检查配置？","slug":"如何检查配置","link":"#如何检查配置","children":[]}],"relativePath":"install/index.md","lastUpdated":1675164401000}'),r={name:"install/index.md"},y=a(`<h1 id="自定义配置-mog-core" tabindex="-1">自定义配置 Mog Core <a class="header-anchor" href="#自定义配置-mog-core" aria-hidden="true">#</a></h1><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>此功能与原本规划的具有一定区别，请注意文档的改变。</p></div><p>Mog 的主要优势之一是它可以弹性组装服务。只要你的条件允许，你可以将服务部署至不同的终端中，但一般你只需部署到同一个终端上即可。但是当你需要配置网关连接服务的IP时（也就是当你将服务部署到了不同的终端时）你需要对 Core 进行配置</p><p><strong>所以一般来说，如果你只部署到了同一个终端上，以下的内容你是不需要了解且填写的，配置的内容越多，越容易出问题。</strong></p><h2 id="启动命令的改变" tabindex="-1">启动命令的改变 <a class="header-anchor" href="#启动命令的改变" aria-hidden="true">#</a></h2><p>我们提到「使用 NestJS CLI 命令启动你已构建完成的服务」使用的命令为</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#80A665;">node</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">&lt;</span><span style="color:#C98A7D;">server</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D;">bundle</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D;">storge</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D;">pat</span><span style="color:#DBD7CAEE;">h</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#59873A;">node</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">&lt;</span><span style="color:#B56959;">server</span><span style="color:#393A34;"> </span><span style="color:#B56959;">bundle</span><span style="color:#393A34;"> </span><span style="color:#B56959;">storge</span><span style="color:#393A34;"> </span><span style="color:#B56959;">pat</span><span style="color:#393A34;">h</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>当我们需要在启动 Mog 进行配置的时候，则需要命令之后在后方携带 <code>--&lt;arg_name&gt;=&lt;arg_value&gt;</code> 格式的参数启动</p><h2 id="配置-core" tabindex="-1">配置 Core <a class="header-anchor" href="#配置-core" aria-hidden="true">#</a></h2><p>当你将服务部署到了不同的终端时，你需要对 Mog Core 的网关层进行配置。</p><p>目前支持配置的字段可以查阅 <a href="/config/">配置索引</a></p><p>我们同样支持 YAML 格式的配置文件，你可以在启动的文件夹下创建 <code>core.yml</code> 文件，然后将配置写入其中</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#B8A965;">core</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 网关层</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">port</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">3000</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 网关层公开端口</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">allow_origins</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7D;">example.com</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D;">excccc.com</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 网关层允许的跨域来源，这个地方也可以写成 localhost:9528,localhost:2323,localhost:2222 而不需要 Object</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B8A965;">collection_name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">mog</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 数据库的集合名</span></span>
<span class="line"><span style="color:#B8A965;">db_host</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">localhost</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 数据库主机地址</span></span>
<span class="line"><span style="color:#758575DD;">#...more</span></span>
<span class="line"></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#998418;">core</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 网关层</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">port</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">3000</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 网关层公开端口</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">allow_origins</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B56959;">example.com</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959;">excccc.com</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 网关层允许的跨域来源，这个地方也可以写成 localhost:9528,localhost:2323,localhost:2222 而不需要 Object</span></span>
<span class="line"></span>
<span class="line"><span style="color:#998418;">collection_name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">mog</span><span style="color:#B56959AA;">&#39;</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 数据库的集合名</span></span>
<span class="line"><span style="color:#998418;">db_host</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">localhost</span><span style="color:#B56959AA;">&#39;</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 数据库主机地址</span></span>
<span class="line"><span style="color:#A0ADA0;">#...more</span></span>
<span class="line"></span></code></pre></div><h2 id="启动-core" tabindex="-1">启动 Core <a class="header-anchor" href="#启动-core" aria-hidden="true">#</a></h2><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-PGaTX" id="tab-uSanhrr" checked="checked"><label for="tab-uSanhrr">使用 Node 启动</label><input type="radio" name="group-PGaTX" id="tab-ftkppq7"><label for="tab-ftkppq7">使用 NestJS CLI 启动</label></div><div class="blocks"><div class="language-bash active"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#80A665;">node</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D;">dist/apps/core/main.js</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">\\</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#C99076;">--db_host=localhost</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">\\</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#C99076;">--config=core.yml</span></span>
<span class="line"></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#59873A;">node</span><span style="color:#393A34;"> </span><span style="color:#B56959;">dist/apps/core/main.js</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">\\</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#A65E2B;">--db_host=localhost</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">\\</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#A65E2B;">--config=core.yml</span></span>
<span class="line"></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#80A665;">nest</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D;">start</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D;">core</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">\\</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#C99076;">--</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">\\</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#C99076;">--db_host=localhost</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">\\</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#C99076;">--config=core.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 或者是只使用 YAML 格式的配置文件</span></span>
<span class="line"></span>
<span class="line"><span style="color:#80A665;">nest</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D;">start</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D;">core</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">\\</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#C99076;">--</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">\\</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#C99076;">--config=core.yml</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span></span>
<span class="line"></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#59873A;">nest</span><span style="color:#393A34;"> </span><span style="color:#B56959;">start</span><span style="color:#393A34;"> </span><span style="color:#B56959;">core</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">\\</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#A65E2B;">--</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">\\</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#A65E2B;">--db_host=localhost</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">\\</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#A65E2B;">--config=core.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 或者是只使用 YAML 格式的配置文件</span></span>
<span class="line"></span>
<span class="line"><span style="color:#59873A;">nest</span><span style="color:#393A34;"> </span><span style="color:#B56959;">start</span><span style="color:#393A34;"> </span><span style="color:#B56959;">core</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">\\</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#A65E2B;">--</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">\\</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#A65E2B;">--config=core.yml</span></span>
<span class="line"><span style="color:#393A34;">  </span></span>
<span class="line"></span></code></pre></div></div></div>`,15),i={id:"",tabindex:"-1"},A=s("a",{class:"header-anchor",href:"#","aria-hidden":"true"},"#",-1),d=a(`<p>无论如何都需要携带YAML配置文件，若不进行配置则会自动获取当前执行目录下的 env.yaml 文件，若文件不存在则会报错，如果全部默认参数也需要存在这个文件</p><p>命令行允许输入的参数有限，所以我们建议使用 YAML 格式的配置文件。有关允许命令行输入的参数可以查阅 <a href="/config/">配置索引</a></p><hr><h2 id="如何检查配置" tabindex="-1">如何检查配置？ <a class="header-anchor" href="#如何检查配置" aria-hidden="true">#</a></h2><p>当 core 启动时，你可以看到出现了一个类似于 JSON 对象的文本内容，应该出现类似的内容</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">collection_name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">mog</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">db_host</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">localhost</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#666666;">  </span><span style="color:#758575DD;">// ...</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">collection_name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">mog</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">db_host</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">localhost</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#999999;">  </span><span style="color:#A0ADA0;">// ...</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><p>你可以在此处检查你的配置正确或否</p><p>更多配置项请查阅 <a href="/config/">配置索引</a></p>`,8);function D(C,h,E,B,g,_){const n=l;return o(),e("div",null,[y,s("h3",i,[c(n,{text:"⚠️ 警告",color:"yellow"}),t(),A]),d])}const u=p(r,[["render",D]]);export{b as __pageData,u as default};
